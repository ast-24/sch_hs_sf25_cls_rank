# 納品書

## 概要

### システムの目的

- クイズ企画「坂井の人事」におけるプレイヤーのスコア管理
- リアルタイムランキング表示
- スタッフによる結果入力サポート

### 主要機能

1. **プレイヤー管理**: プレイヤーIDの発行と表示名管理
2. **スコア計算**: 連続正解・不正解による複雑なスコア計算
3. **ランキング表示**: 4種類のランキング（累積・ラウンド別・最大・最新）
4. **結果入力**: スタッフ用の直感的な入力インターフェース

## システム仕様

### スコア計算ルール

企画の核となるスコア計算は以下の通りです：

- **初期スコア**: 0点
- **正解**: +100点 × 連続正解数
- **不正解**: -500点 × 連続不正解数
- **パス**: スコアに影響しないが、連続判定をリセット
- **負のスコア**: 下限0（0未満にはならない）  
  なお内部的には負を許可し、計算途中やランキング算出時は負を考慮しています。

**計算例**:

- 1問目正解: +100点（連続1回目）
- 2問目正解: +200点（連続2回目）
- 3問目不正解: -500点（連続1回目）
- 4問目パス: 0点（連続リセット）
- 5問目不正解: -500点（連続1回目）

### プレイヤーID形式

`{ルームID(1-3)}{通し番号(001-999)}`

例: `1001`, `2001`, `3001`

### ランキング種別

1. **累積スコア**: 全ラウンドの合計スコア
2. **ラウンドスコア**: 個別ラウンドのスコア一覧
3. **最大ラウンドスコア**: プレイヤー別の最高ラウンドスコア
4. **最新ラウンドスコア**: 各ルーム直近3分以内の最新ラウンド

## システム構成

### 技術スタック

- **フロントエンド**: HTML5, CSS3, Vanilla JavaScript
- **バックエンド**: Cloudflare Workers (Serverless API)
- **ホスティング**: Cloudflare Pages
- **データベース**: TiDB Serverless
- **開発環境**: Node.js ローカルサーバー

### アクセス方法

システムは以下のURLからアクセス可能です：

**本番環境**:

`https://skijnjrank.ast24.dev/`

## 運用について

### 必要なスタッフ

- **ルームスタッフ**: 3名（各ルーム1名）
- **表示管理**: 1名（ランキング表示操作）

### 推奨環境

- **スタッフ用端末**: スマートフォン
- **表示用端末**: PC + プロジェクター
- **ネットワーク**: 安定したWi-Fi環境

## セキュリティ・制限事項

### セキュリティ対策

- URLベースのアクセス制御（非公開URL）
- 入力値検証機能

### 制限事項

- **同時接続数**: 最大20接続程度を想定
- **認証機能**: 現在未実装（URL秘匿による保護）

### 既知の注意点

- プレイヤーIDは連番のため予測可能
- スタッフ用URLの管理に注意が必要

---

**納品日**: 2025年8月7日  
**開発者**: ast\<code@ast24.dev\>  
**プロジェクト**: sf25-cls-rank
